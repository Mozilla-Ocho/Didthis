(self.webpackChunkappserver=self.webpackChunkappserver||[]).push([[95],{"./node_modules/@storybook/nextjs/dist sync recursive":module=>{function webpackEmptyContext(req){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}webpackEmptyContext.keys=()=>[],webpackEmptyContext.resolve=webpackEmptyContext,webpackEmptyContext.id="./node_modules/@storybook/nextjs/dist sync recursive",module.exports=webpackEmptyContext},"./src/components/RemindersAndAlerts.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{v:()=>RemindersAndAlerts,Z:()=>components_RemindersAndAlerts});var react=__webpack_require__("./node_modules/react/index.js"),lib_store=__webpack_require__("./src/lib/store/index.tsx"),__jsx=react.createElement,DiscordNag=function DiscordNag(){return __jsx(react.Fragment,null)};DiscordNag.__docgenInfo={description:"",methods:[],displayName:"DiscordNag"};const components_DiscordNag=DiscordNag;var ClaimTrialAccountButton=__webpack_require__("./src/components/auth/ClaimTrialAccountButton.tsx"),branding=__webpack_require__("./src/lib/branding.tsx"),TrialAccountNag_jsx=react.createElement,TrialAccountNag=function TrialAccountNag(_ref){var projects=_ref.user.profile.projects;return 0==Object.keys(projects).length?TrialAccountNag_jsx(react.Fragment,null):TrialAccountNag_jsx("div",{className:"w-full max-w-[1280px] mx-auto px-4 py-4 sm:px-6 md:px-8 lg:px-10 xl:px-16 bg-trialaccountnag"},TrialAccountNag_jsx("div",{className:"grid grid-cols-[auto_1fr] gap-4 items-start"},TrialAccountNag_jsx("div",{className:"text-sm"},"To save your work, share it publicly, and to sign in from other devices, create a ",branding.Z.productName," account."),TrialAccountNag_jsx("div",null,TrialAccountNag_jsx("div",{className:"text-sm text-end whitespace-nowrap"},TrialAccountNag_jsx(ClaimTrialAccountButton.T,{intent:"link",skipConfirmation:!0})))))};TrialAccountNag.displayName="TrialAccountNag",TrialAccountNag.__docgenInfo={description:"",methods:[],displayName:"TrialAccountNag",props:{user:{required:!0,tsType:{name:"ApiUser"},description:""}}};const components_TrialAccountNag=TrialAccountNag;try{TrialAccountNag.displayName="TrialAccountNag",TrialAccountNag.__docgenInfo={description:"",displayName:"TrialAccountNag",props:{user:{defaultValue:null,description:"",name:"user",required:!0,type:{name:"ApiUser"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/TrialAccountNag.tsx#TrialAccountNag"]={docgenInfo:TrialAccountNag.__docgenInfo,name:"TrialAccountNag",path:"src/components/TrialAccountNag.tsx#TrialAccountNag"})}catch(__react_docgen_typescript_loader_error){}var uiLib=__webpack_require__("./src/components/uiLib/index.tsx");const feedback={src:"static/media/feedback.796614e8.svg",height:150,width:150,blurDataURL:"static/media/feedback.796614e8.svg"};var next_image=__webpack_require__("./node_modules/@storybook/nextjs/dist/images/next-image.mjs"),TrialAccountSignedUpAlert_jsx=react.createElement,TrialAccountSignedUpAlert=function TrialAccountSignedUpAlert(){return TrialAccountSignedUpAlert_jsx(uiLib.Jp,{wide:!0,noPadY:!0},TrialAccountSignedUpAlert_jsx("div",{id:"trialaccountsignedup",className:"py-4 px-6 mt-4 bg-trialaccountsignedup"},TrialAccountSignedUpAlert_jsx("div",{className:"grid grid-cols-[auto_1fr] gap-2 items-start"},TrialAccountSignedUpAlert_jsx(next_image.Z,{className:"inline w-8 h-8",src:feedback,alt:"feedback icon"}),TrialAccountSignedUpAlert_jsx("div",{className:"text-sm"},"Hi there, ",branding.Z.productName," alpha tester, you're all signed up! Welcome to your new account!"))))};TrialAccountSignedUpAlert.displayName="TrialAccountSignedUpAlert",TrialAccountSignedUpAlert.__docgenInfo={description:"",methods:[],displayName:"TrialAccountSignedUpAlert"};const components_TrialAccountSignedUpAlert=TrialAccountSignedUpAlert;var appShellContent=__webpack_require__("./src/lib/appShellContent/index.ts"),RemindersAndAlerts_jsx=react.createElement,RemindersAndAlerts=function RemindersAndAlerts(){var store=(0,lib_store.oR)(),_useState=(0,react.useState)(!1),showTrialAccountSignedUpAlert=_useState[0],setShowTrialAccountSignedUpAlert=_useState[1],appShell=(0,appShellContent.ZP)();return(0,react.useEffect)((function(){var val=store.wasTrialAccountClaimed();setShowTrialAccountSignedUpAlert(val),setTimeout((function(){store.clearTrialAccountClaimed()}),5e3)}),[store]),appShell.inAppWebView?RemindersAndAlerts_jsx(react.Fragment,null):RemindersAndAlerts_jsx(react.Fragment,null,store.user&&store.user.isTrial&&RemindersAndAlerts_jsx(components_TrialAccountNag,{user:store.user}),RemindersAndAlerts_jsx(showTrialAccountSignedUpAlert?components_TrialAccountSignedUpAlert:components_DiscordNag,null))};RemindersAndAlerts.__docgenInfo={description:"",methods:[],displayName:"RemindersAndAlerts"};const components_RemindersAndAlerts=RemindersAndAlerts},"./src/lib/appShellContent/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{ZP:()=>useAppShell,nH:()=>useAppShellListener,xd:()=>useAppShellTopBar});var react=__webpack_require__("./node_modules/react/index.js"),slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),defineProperty=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),classCallCheck=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/classCallCheck.js"),createClass=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createClass.js"),regenerator=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),console=__webpack_require__("./node_modules/console-browserify/index.js");function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){(0,defineProperty.Z)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}var MESSAGE_EVENT="AppShellMessage",MessageHandler=function(){function MessageHandler(){(0,classCallCheck.Z)(this,MessageHandler),(0,defineProperty.Z)(this,"pendingRequests",void 0),(0,defineProperty.Z)(this,"listener",void 0),(0,defineProperty.Z)(this,"lastId",void 0),this.pendingRequests={},this.listener=void 0,this.lastId=0}var _request;return(0,createClass.Z)(MessageHandler,[{key:"generateRequestId",value:function generateRequestId(){return this.lastId++,"request-".concat(this.lastId)}},{key:"getWebView",value:function getWebView(){if("undefined"!=typeof window&&void 0!==window.ReactNativeWebView&&void 0!==window.ReactNativeWebView.postMessage)return window.ReactNativeWebView}},{key:"request",value:(_request=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(method,payload){var request,_this=this;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return request={type:"request",id:this.generateRequestId(),method,payload},_context.abrupt("return",new Promise((function(resolve,reject){var webview=_this.getWebView();if(!webview)return reject(new Error("not in app shell"));_this.pendingRequests[request.id]=_objectSpread(_objectSpread({},request),{},{resolve,reject}),webview.postMessage(JSON.stringify(request))})));case 2:case"end":return _context.stop()}}),_callee,this)}))),function request(_x,_x2){return _request.apply(this,arguments)})},{key:"listen",value:function listen(){this.listener&&this.unlisten(),this.listener=this.handleMessage.bind(this),window.addEventListener("message",this.listener),document.addEventListener("message",this.listener)}},{key:"unlisten",value:function unlisten(){this.listener&&(window.removeEventListener("message",this.listener),document.removeEventListener("message",this.listener))}},{key:"handleMessage",value:function handleMessage(event){try{if(void 0===event.data)return;var dataEvent=event,_JSON$parse=JSON.parse(dataEvent.data),type=_JSON$parse.type,_id=_JSON$parse.id,_payload=_JSON$parse.payload;if(document.dispatchEvent(new CustomEvent(MESSAGE_EVENT,{detail:{type,id:_id,payload:_payload}})),"response"===type){var pending=this.pendingRequests[_id];pending&&"object"==typeof _payload&&(delete this.pendingRequests[_id],"failure"in _payload?pending.reject(_payload):pending.resolve(_payload))}}catch(e){console.error("Failed to handle message",e)}}}]),MessageHandler}();function useAppShellListener(expectedType,handler){var listener=(0,react.useRef)();(0,react.useEffect)((function(){if(handler)return"undefined"!=typeof document&&(listener.current=function(ev){var detail=ev.detail,type=detail.type,payload=detail.payload,id=detail.id;expectedType===type&&handler(payload,id)},document.addEventListener(MESSAGE_EVENT,listener.current)),function(){listener.current&&document.removeEventListener(MESSAGE_EVENT,listener.current)}}),[expectedType,handler,listener])}const api=function(){function AppShellAPI(){(0,classCallCheck.Z)(this,AppShellAPI),(0,defineProperty.Z)(this,"messaging",void 0),this.messaging=new MessageHandler}var _request;return(0,createClass.Z)(AppShellAPI,[{key:"isInWebView",value:function isInWebView(){return!!this.messaging.getWebView()}},{key:"init",value:function init(){this.messaging.listen()}},{key:"deinit",value:function deinit(){this.messaging.unlisten()}},{key:"request",value:(_request=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(method,payload){return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!this.isInWebView()){_context.next=2;break}return _context.abrupt("return",this.messaging.request(method,payload));case 2:case"end":return _context.stop()}}),_callee,this)}))),function request(_x,_x2){return _request.apply(this,arguments)})}]),AppShellAPI}();function state_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function state_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?state_ownKeys(Object(source),!0).forEach((function(key){(0,defineProperty.Z)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):state_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function createInitialState(){return{inAppWebView:!1,appReady:!1,appVersionInfo:{},api:new api}}function reducer(state,action){return"update"===action.type?state_objectSpread(state_objectSpread({},state),{},(0,defineProperty.Z)({},action.key,action.value)):state}var config=__webpack_require__("./node_modules/next/config.js"),config_default=__webpack_require__.n(config),next_router=__webpack_require__("./node_modules/next/router.js"),lib_store=__webpack_require__("./src/lib/store/index.tsx"),pathBuilder=__webpack_require__("./src/lib/pathBuilder.ts"),trackingEvents=__webpack_require__("./src/lib/trackingEvents.ts"),__jsx=react.createElement,publicRuntimeConfig=config_default()().publicRuntimeConfig,SERVER_VERSION=null==publicRuntimeConfig?void 0:publicRuntimeConfig.version,SERVER_BUILD=null==publicRuntimeConfig?void 0:publicRuntimeConfig.build,SERVER_TAG=null==publicRuntimeConfig?void 0:publicRuntimeConfig.tag,AppShellContext=(0,react.createContext)(createInitialState());function AppShellContextProvider(_ref){var children=_ref.children,_useAppShellState=function useAppShellState(){var _useReducer=(0,react.useReducer)(reducer,null,createInitialState);return[_useReducer[0],_useReducer[1]]}(),_useAppShellState2=(0,slicedToArray.Z)(_useAppShellState,2),state=_useAppShellState2[0],dispatch=_useAppShellState2[1],router=(0,next_router.useRouter)(),store=(0,lib_store.oR)(),inAppWebView=state.inAppWebView,api=state.api,isInWebView=api.isInWebView();return isInWebView&&(store.appShellApiRef=api),(0,react.useEffect)((function(){dispatch({type:"update",key:"inAppWebView",value:!!isInWebView})}),[isInWebView,dispatch]),(0,react.useEffect)((function(){if(inAppWebView)return api.init(),api.request("ping",{version:SERVER_VERSION,build:SERVER_BUILD,tag:SERVER_TAG}).then((function(){dispatch({type:"update",key:"appVersionInfo",value:arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}}),dispatch({type:"update",key:"appReady",value:!0})})),function(){return api.deinit()}}),[inAppWebView,api,dispatch]),(0,react.useEffect)((function(){var handleRouteChangeStart=function handleRouteChangeStart(url){api.request("webviewRouterEvent",{event:"routeChangeStart",url})},handleRouteChangeComplete=function handleRouteChangeComplete(url){api.request("webviewRouterEvent",{event:"routeChangeComplete",url}),api.request("updateTopNav",{show:!1})};router.events.on("routeChangeStart",handleRouteChangeStart),router.events.on("routeChangeComplete",handleRouteChangeComplete);var deregUserListen=store.registerUserListener((function(theUser){theUser&&api.request("updateAppConfig",{user:theUser,links:{user:pathBuilder.Z.user(theUser.systemSlug),userEdit:pathBuilder.Z.userEdit(theUser.systemSlug),newPost:pathBuilder.Z.newPost(theUser.systemSlug)}})}));return function(){deregUserListen(),router.events.off("routeChangeStart",handleRouteChangeStart),router.events.off("routeChangeComplete",handleRouteChangeComplete)}}),[api,router,store,state.appReady]),useAppShellListener("trackNativeEvent",(function(_ref2){var event=_ref2.event;"bcNativeDrawerOpen"===event&&store.trackEvent(trackingEvents.M.bcNativeDrawerOpen),"bcNativeDrawerCreateProject"===event&&store.trackEvent(trackingEvents.M.bcNativeDrawerCreateProject),"bcNativeDrawerProject"===event&&store.trackEvent(trackingEvents.M.bcNativeDrawerProject)})),useAppShellListener("navigateToPath",(function(_ref3){var path=_ref3.path;return router.push(path)})),__jsx(AppShellContext.Provider,{value:state},children)}AppShellContextProvider.displayName="AppShellContextProvider",AppShellContextProvider.__docgenInfo={description:"",methods:[],displayName:"AppShellContextProvider",props:{children:{required:!0,tsType:{name:"ReactNode"},description:""}}};try{context.displayName="context",context.__docgenInfo={description:"",displayName:"context",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/lib/appShellContent/context.tsx#context"]={docgenInfo:context.__docgenInfo,name:"context",path:"src/lib/appShellContent/context.tsx#context"})}catch(__react_docgen_typescript_loader_error){}var objectWithoutProperties=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),_excluded=["onLeftPress","onRightPress","onSharePress","onEditPress"],noop=function noop(){};function useAppShellTopBar(params){var _params$onLeftPress=params.onLeftPress,onLeftPress=void 0===_params$onLeftPress?noop:_params$onLeftPress,_params$onRightPress=params.onRightPress,onRightPress=void 0===_params$onRightPress?noop:_params$onRightPress,_params$onSharePress=params.onSharePress,onSharePress=void 0===_params$onSharePress?noop:_params$onSharePress,_params$onEditPress=params.onEditPress,onEditPress=void 0===_params$onEditPress?noop:_params$onEditPress,state=(0,objectWithoutProperties.Z)(params,_excluded),appShell=useAppShell();useAppShellListener("topNavLeftPress",onLeftPress),useAppShellListener("topNavRightPress",onRightPress),useAppShellListener("topNavSharePress",onSharePress),useAppShellListener("topNavEditPress",onEditPress),(0,react.useEffect)((function(){appShell.api.request("updateTopNav",state)}),[state,appShell.api])}try{useAppShellTopBar.displayName="useAppShellTopBar",useAppShellTopBar.__docgenInfo={description:"",displayName:"useAppShellTopBar",props:{show:{defaultValue:null,description:"",name:"show",required:!1,type:{name:"boolean"}},title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string"}},leftIsBack:{defaultValue:null,description:"",name:"leftIsBack",required:!1,type:{name:"boolean"}},leftLabel:{defaultValue:null,description:"",name:"leftLabel",required:!1,type:{name:"string"}},leftIsDisabled:{defaultValue:null,description:"",name:"leftIsDisabled",required:!1,type:{name:"boolean"}},rightLabel:{defaultValue:null,description:"",name:"rightLabel",required:!1,type:{name:"string"}},rightIsDisabled:{defaultValue:null,description:"",name:"rightIsDisabled",required:!1,type:{name:"boolean"}},showShare:{defaultValue:null,description:"",name:"showShare",required:!1,type:{name:"boolean"}},shareIsDisabled:{defaultValue:null,description:"",name:"shareIsDisabled",required:!1,type:{name:"boolean"}},showEdit:{defaultValue:null,description:"",name:"showEdit",required:!1,type:{name:"boolean"}},editIsDisabled:{defaultValue:null,description:"",name:"editIsDisabled",required:!1,type:{name:"boolean"}},onLeftPress:{defaultValue:null,description:"",name:"onLeftPress",required:!1,type:{name:"(() => void)"}},onRightPress:{defaultValue:null,description:"",name:"onRightPress",required:!1,type:{name:"(() => void)"}},onSharePress:{defaultValue:null,description:"",name:"onSharePress",required:!1,type:{name:"(() => void)"}},onEditPress:{defaultValue:null,description:"",name:"onEditPress",required:!1,type:{name:"(() => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/lib/appShellContent/ui.tsx#useAppShellTopBar"]={docgenInfo:useAppShellTopBar.__docgenInfo,name:"useAppShellTopBar",path:"src/lib/appShellContent/ui.tsx#useAppShellTopBar"})}catch(__react_docgen_typescript_loader_error){}function useAppShell(){return(0,react.useContext)(AppShellContext)}}}]);